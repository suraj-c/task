/*! For license information please see canvas-toBlob.js.LICENSE.txt */
!function(view){"use strict";var base64_ranks,Uint8Array=view.Uint8Array,HTMLCanvasElement=view.HTMLCanvasElement,canvas_proto=HTMLCanvasElement&&HTMLCanvasElement.prototype,is_base64_regex=/\s*;\s*base64\s*(?:;|$)/i,to_data_url="toDataURL",decode_base64=function(base64){for(var rank,code,len=base64.length,buffer=new Uint8Array(len/4*3|0),i=0,outptr=0,last=[0,0],state=0,save=0;len--;)code=base64.charCodeAt(i++),255!==(rank=base64_ranks[code-43])&&undefined!==rank&&(last[1]=last[0],last[0]=code,save=save<<6|rank,4===++state&&(buffer[outptr++]=save>>>16,61!==last[1]&&(buffer[outptr++]=save>>>8),61!==last[0]&&(buffer[outptr++]=save),state=0));return buffer};Uint8Array&&(base64_ranks=new Uint8Array([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),!HTMLCanvasElement||canvas_proto.toBlob&&canvas_proto.toBlobHD||(canvas_proto.toBlob||(canvas_proto.toBlob=function(callback,type){if(type||(type="image/png"),this.mozGetAsFile)callback(this.mozGetAsFile("canvas",type));else if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(type))callback(this.msToBlob());else{var blob,args=Array.prototype.slice.call(arguments,1),dataURI=this[to_data_url].apply(this,args),header_end=dataURI.indexOf(","),data=dataURI.substring(header_end+1),is_base64=is_base64_regex.test(dataURI.substring(0,header_end));Blob.fake?((blob=new Blob).encoding=is_base64?"base64":"URI",blob.data=data,blob.size=data.length):Uint8Array&&(blob=is_base64?new Blob([decode_base64(data)],{type:type}):new Blob([decodeURIComponent(data)],{type:type})),callback(blob)}}),!canvas_proto.toBlobHD&&canvas_proto.toDataURLHD?canvas_proto.toBlobHD=function(){to_data_url="toDataURLHD";var blob=this.toBlob();return to_data_url="toDataURL",blob}:canvas_proto.toBlobHD=canvas_proto.toBlob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this);