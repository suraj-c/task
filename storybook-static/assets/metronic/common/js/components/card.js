"use strict";var KTCard=function(elementId,options){var the=this,element=KTUtil.getById(elementId),body=KTUtil.getBody();if(element){var defaultOptions={toggleSpeed:400,sticky:{releseOnReverse:!1,offset:300,zIndex:101}},Plugin={construct:function(options){return KTUtil.data(element).has("card")?the=KTUtil.data(element).get("card"):(Plugin.init(options),Plugin.build(),KTUtil.data(element).set("card",the)),the},init:function(options){the.element=element,the.events=[],the.options=KTUtil.deepExtend({},defaultOptions,options),the.header=KTUtil.child(element,".card-header"),the.footer=KTUtil.child(element,".card-footer"),KTUtil.child(element,".card-body")?the.body=KTUtil.child(element,".card-body"):KTUtil.child(element,".form")&&(the.body=KTUtil.child(element,".form"))},build:function(){var remove=KTUtil.find(the.header,"[data-card-tool=remove]");remove&&KTUtil.addEvent(remove,"click",(function(e){e.preventDefault(),Plugin.remove()}));var reload=KTUtil.find(the.header,"[data-card-tool=reload]");reload&&KTUtil.addEvent(reload,"click",(function(e){e.preventDefault(),Plugin.reload()}));var toggle=KTUtil.find(the.header,"[data-card-tool=toggle]");toggle&&KTUtil.addEvent(toggle,"click",(function(e){e.preventDefault(),Plugin.toggle()}))},initSticky:function(){the.options.sticky.offset;the.header&&window.addEventListener("scroll",Plugin.onScrollSticky)},onScrollSticky:function(e){var offset=the.options.sticky.offset;if(!isNaN(offset)){var st=KTUtil.getScrollTop();st>=offset&&!1===KTUtil.hasClass(body,"card-sticky-on")?(Plugin.eventTrigger("stickyOn"),KTUtil.addClass(body,"card-sticky-on"),Plugin.updateSticky()):1.5*st<=offset&&KTUtil.hasClass(body,"card-sticky-on")&&(Plugin.eventTrigger("stickyOff"),KTUtil.removeClass(body,"card-sticky-on"),Plugin.resetSticky())}},updateSticky:function(){var top,left,right;the.header&&(KTUtil.hasClass(body,"card-sticky-on")&&(top=the.options.sticky.position.top instanceof Function?parseInt(the.options.sticky.position.top.call(this,the)):parseInt(the.options.sticky.position.top),left=the.options.sticky.position.left instanceof Function?parseInt(the.options.sticky.position.left.call(this,the)):parseInt(the.options.sticky.position.left),right=the.options.sticky.position.right instanceof Function?parseInt(the.options.sticky.position.right.call(this,the)):parseInt(the.options.sticky.position.right),KTUtil.css(the.header,"z-index",the.options.sticky.zIndex),KTUtil.css(the.header,"top",top+"px"),KTUtil.css(the.header,"left",left+"px"),KTUtil.css(the.header,"right",right+"px")))},resetSticky:function(){the.header&&!1===KTUtil.hasClass(body,"card-sticky-on")&&(KTUtil.css(the.header,"z-index",""),KTUtil.css(the.header,"top",""),KTUtil.css(the.header,"left",""),KTUtil.css(the.header,"right",""))},remove:function(){!1!==Plugin.eventTrigger("beforeRemove")&&(KTUtil.remove(element),Plugin.eventTrigger("afterRemove"))},setContent:function(html){html&&(the.body.innerHTML=html)},getBody:function(){return the.body},getSelf:function(){return element},reload:function(){Plugin.eventTrigger("reload")},toggle:function(){KTUtil.hasClass(element,"card-collapse")||KTUtil.hasClass(element,"card-collapsed")?Plugin.expand():Plugin.collapse()},collapse:function(){!1!==Plugin.eventTrigger("beforeCollapse")&&(KTUtil.slideUp(the.body,the.options.toggleSpeed,(function(){Plugin.eventTrigger("afterCollapse")})),KTUtil.addClass(element,"card-collapse"))},expand:function(){!1!==Plugin.eventTrigger("beforeExpand")&&(KTUtil.slideDown(the.body,the.options.toggleSpeed,(function(){Plugin.eventTrigger("afterExpand")})),KTUtil.removeClass(element,"card-collapse"),KTUtil.removeClass(element,"card-collapsed"))},eventTrigger:function(name){for(var i=0;i<the.events.length;i++){var event=the.events[i];if(event.name==name){if(1!=event.one)return event.handler.call(this,the);if(0==event.fired)return the.events[i].fired=!0,event.handler.call(this,the)}}},addEvent:function(name,handler,one){return the.events.push({name:name,handler:handler,one:one,fired:!1}),the}};return the.setDefaults=function(options){defaultOptions=options},the.remove=function(){return Plugin.remove(html)},the.initSticky=function(){return Plugin.initSticky()},the.updateSticky=function(){return Plugin.updateSticky()},the.resetSticky=function(){return Plugin.resetSticky()},the.destroySticky=function(){Plugin.resetSticky(),window.removeEventListener("scroll",Plugin.onScrollSticky)},the.reload=function(){return Plugin.reload()},the.setContent=function(html){return Plugin.setContent(html)},the.toggle=function(){return Plugin.toggle()},the.collapse=function(){return Plugin.collapse()},the.expand=function(){return Plugin.expand()},the.getBody=function(){return Plugin.getBody()},the.getSelf=function(){return Plugin.getSelf()},the.on=function(name,handler){return Plugin.addEvent(name,handler)},the.one=function(name,handler){return Plugin.addEvent(name,handler,!0)},Plugin.construct.apply(the,[options]),the}};"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=KTCard);