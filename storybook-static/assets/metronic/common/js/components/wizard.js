"use strict";var KTWizard=function(elementId,options){var the=this,element=KTUtil.getById(elementId);KTUtil.getBody();if(element){var defaultOptions={startStep:1,clickableSteps:!1},Plugin={construct:function(options){return KTUtil.data(element).has("wizard")?the=KTUtil.data(element).get("wizard"):(Plugin.init(options),Plugin.build(),KTUtil.data(element).set("wizard",the)),the},init:function(options){the.element=element,the.events=[],the.options=KTUtil.deepExtend({},defaultOptions,options),the.steps=KTUtil.findAll(element,'[data-wizard-type="step"]'),the.btnNext=KTUtil.find(element,'[data-wizard-type="action-next"]'),the.btnPrev=KTUtil.find(element,'[data-wizard-type="action-prev"]'),the.btnSubmit=KTUtil.find(element,'[data-wizard-type="action-submit"]'),the.events=[],the.lastStep=0,the.currentStep=1,the.newStep=0,the.stopped=!1,the.totalSteps=the.steps.length,the.options.startStep>1&&Plugin.goTo(the.options.startStep),Plugin.updateUI()},build:function(){KTUtil.addEvent(the.btnNext,"click",(function(e){e.preventDefault(),Plugin.setNewStep(Plugin.getNextStep()),!1!==Plugin.eventTrigger("change")&&Plugin.goTo(Plugin.getNextStep())})),KTUtil.addEvent(the.btnPrev,"click",(function(e){e.preventDefault(),Plugin.setNewStep(Plugin.getPrevStep()),!1!==Plugin.eventTrigger("change")&&Plugin.goTo(Plugin.getPrevStep())})),!0===the.options.clickableSteps&&KTUtil.on(element,'[data-wizard-type="step"]',"click",(function(){var index=KTUtil.index(this)+1;index!==the.currentStep&&(Plugin.setNewStep(index),!1!==Plugin.eventTrigger("change")&&Plugin.goTo(index))})),KTUtil.addEvent(the.btnSubmit,"click",(function(e){e.preventDefault(),Plugin.eventTrigger("submit")}))},goTo:function(number){if(!0!==the.stopped){if(!(number===the.currentStep||number>the.totalSteps||number<0))return number=parseInt(number),the.lastStep=the.currentStep,the.currentStep=number,the.newStep=0,Plugin.updateUI(),Plugin.eventTrigger("changed"),the}else the.stopped=!1},stop:function(){the.stopped=!0},resume:function(){the.stopped=!1},isLastStep:function(){return the.currentStep===the.totalSteps},isFirstStep:function(){return 1===the.currentStep},isBetweenStep:function(){return!1===Plugin.isLastStep()&&!1===Plugin.isFirstStep()},updateUI:function(){var stepType="",index=the.currentStep-1;stepType=Plugin.isLastStep()?"last":Plugin.isFirstStep()?"first":"between",KTUtil.attr(the.element,"data-wizard-state",stepType);var steps=KTUtil.findAll(the.element,'[data-wizard-type="step"]');if(steps&&steps.length>0)for(var i=0,len=steps.length;i<len;i++)i==index?KTUtil.attr(steps[i],"data-wizard-state","current"):i<index?KTUtil.attr(steps[i],"data-wizard-state","done"):KTUtil.attr(steps[i],"data-wizard-state","pending");var stepsInfo=KTUtil.findAll(the.element,'[data-wizard-type="step-info"]');if(stepsInfo&&stepsInfo.length>0)for(i=0,len=stepsInfo.length;i<len;i++)i==index?KTUtil.attr(stepsInfo[i],"data-wizard-state","current"):KTUtil.removeAttr(stepsInfo[i],"data-wizard-state");var stepsContent=KTUtil.findAll(the.element,'[data-wizard-type="step-content"]');if(stepsContent&&stepsContent.length>0)for(i=0,len=stepsContent.length;i<len;i++)i==index?KTUtil.attr(stepsContent[i],"data-wizard-state","current"):KTUtil.removeAttr(stepsContent[i],"data-wizard-state")},getNextStep:function(){return the.totalSteps>=the.currentStep+1?the.currentStep+1:the.totalSteps},getPrevStep:function(){return the.currentStep-1>=1?the.currentStep-1:1},getNewStep:function(){return the.newStep},setNewStep:function(step){the.newStep=step},eventTrigger:function(name,nested){for(var i=0;i<the.events.length;i++){var event=the.events[i];if(event.name==name){if(1!=event.one)return event.handler.call(this,the);if(0==event.fired)return the.events[i].fired=!0,event.handler.call(this,the)}}},addEvent:function(name,handler,one){return the.events.push({name:name,handler:handler,one:one,fired:!1}),the}};return the.setDefaults=function(options){defaultOptions=options},the.goNext=function(){return Plugin.goTo(Plugin.getNextStep())},the.goPrev=function(){return Plugin.goTo(Plugin.getPrevStep())},the.goLast=function(){return Plugin.goTo(Plugin.getLastStep())},the.goFirst=function(){return Plugin.goTo(Plugin.getFirstStep())},the.goTo=function(number){return Plugin.goTo(number)},the.stop=function(){return Plugin.stop()},the.resume=function(){return Plugin.resume()},the.getStep=function(){return the.currentStep},the.getNewStep=function(){return Plugin.getNewStep()},the.setNewStep=function(number){Plugin.setNewStep(number)},the.isLastStep=function(){return Plugin.isLastStep()},the.isFirstStep=function(){return Plugin.isFirstStep()},the.on=function(name,handler){return Plugin.addEvent(name,handler)},the.one=function(name,handler){return Plugin.addEvent(name,handler,!0)},Plugin.construct.apply(the,[options]),the}};"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=KTWizard);